# testapi2
Quick unit test and export document APIs

# Features
1. Test APIs base on scenario files
2. Validate response data, response headers...
3. Re-use variable after each steps
4. Split a big testcases to many smaller testcases which make easy testing for large project
5. Easy to extends for specific project

# How to use
### Installation
```javascript
// install via npm
npm install -g testapi2

// install via yarn
yarn global add testapi2 --prefix /usr/local
```

### Write testcase
- Main scenario file name is `index.testapi2.yaml`

### Run test
```sh
testapi2 \"$PWD/$PATH_OF_SCENARIO_FILE/index.testapi2.yaml\"
```

### Scenario
```yaml
title:                      # Document title
description:                # Document description
info:
  contact:
    email: email@gmail.com  # Author
version: 1.0.0              # Document version
endpoints:                  # Example server in document
  production: https://api.abc.vn/edge-main/v1.0
  staging: https://staging-api.abc.vn/edge-main/v1.0
  development: http://localhost:3001
# debug: true
docs:                               # Config document
  headers: []                       # Doc request headers
  responseHeaders: ["content-type"] # Doc response headers
  output:                           # Output document
    - !output-swagger               # Config for swagger document
      saveTo: ../DOC/api.doc.yaml   # Output path
      raw:                          # Ref to swagger tags
    - !output-md                    # Config for markdown document
      saveTo: ../DOC/api.doc.md
vars:                               # Declare global variables
  url: http://0.0.0.0:3001
templates:                          # Declare templates which not run
  # Make request
  - !api
  - !get
  - !post
  - !put
  - !patch
  - !delete
  - !head
  - !group
steps:
  # Make request
  - !api            # REST API
  - !get            # API GET method
  - !delete         # API DELETE method
  - !head           # API HEAD method
  - !post           # API POST method
  - !put            # API PUT method
  - !patch          # API PATCH method
    - !upload         # Upload file in body request
    - !validate       # Validate logic
  # Print
  - !echo           # Print data
  - !echo-schema    # Print object schema
  # Logic
  - !script         # Inject javascript in scenario
  - !vars           # Declare variables
  # Validate
  - !validate       # Validate logic
  - !status         # Validate response status code
  - !status-text    # Validate response status text
  # Common
  - !pause          # Pause or delay calls
  - !file           # Import files
  - !group          # Group steps
  - !exec           # Execute external command
  - !input          # Get user input keyboard
  - !output-file    # Save data to file
  - !output-swagger # Generate & save document to swagger file
  - !output-md      # Generate & save document to markdown file
```

### All of tags

```yaml
# Make request
- !api            # REST API
- !get            # API GET method
- !delete         # API DELETE method
- !head           # API HEAD method
- !post           # API POST method
- !put            # API PUT method
- !patch          # API PATCH method
  - !upload         # Upload file in body request
  - !validate       # Validate logic
# Print
- !echo           # Print data
- !echo-schema    # Print object schema
- !output-file    # Save data to file
# Logic
- !script         # Inject javascript in scenario
- !vars           # Declare variables
# Validate
- !validate       # Validate logic
- !status         # Validate response status code
- !status-text    # Validate response status text
# Common
- !pause          # Pause or delay calls
- !file           # Import files
- !group          # Group steps
- !exec           # Execute external command
- !input          # Get user input keyboard
# Document
- !doc-swagger # Generate document to swagger file
- !doc-md      # Generate document to markdown file
```

### Scenario schema
[Ref to schema](./schema.json)

### Example

[Examples](./test)